(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d207f72"],{a37a:function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"app-container"},[a("el-form",{ref:"queryForm",attrs:{"label-width":"70px"}},[a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:6}},[a("el-form-item",{attrs:{label:"姓名",prop:"name"}},[a("el-input",{staticStyle:{width:"100%"},attrs:{placeholder:"请输入用户名称",clearable:"",size:"small"},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.handleQuery(e)}},model:{value:t.queryParams.name,callback:function(e){t.$set(t.queryParams,"name",e)},expression:"queryParams.name"}})],1)],1),a("el-col",{attrs:{span:6}},[a("el-form-item",{attrs:{label:"工号",prop:"tutorId"}},[a("el-input",{staticStyle:{width:"100%"},attrs:{placeholder:"请输入用户工号",clearable:"",size:"small"},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.handleQuery(e)}},model:{value:t.queryParams.tutorId,callback:function(e){t.$set(t.queryParams,"tutorId",e)},expression:"queryParams.tutorId"}})],1)],1),a("el-col",{attrs:{span:6}},[a("el-form-item",{attrs:{label:"角色",prop:"roleName"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"用户角色",clearable:"",size:"small"},model:{value:t.queryParams.roleId,callback:function(e){t.$set(t.queryParams,"roleId",e)},expression:"queryParams.roleId"}},[a("el-option",{attrs:{label:"院系秘书",value:"2"}}),a("el-option",{attrs:{label:"研究生院管理员",value:"4"}}),a("el-option",{attrs:{label:"社科处管理员",value:"6"}}),a("el-option",{attrs:{label:"科研处管理员",value:"7"}})],1)],1)],1),a("el-col",{attrs:{span:6}},[a("el-col",{attrs:{span:6,offset:6}},[a("el-button",{attrs:{type:"primary",icon:"el-icon-search",size:"small"},on:{click:t.handleQuery}},[t._v("搜索")])],1),a("el-col",{attrs:{span:6,offset:2}},[a("el-button",{attrs:{icon:"el-icon-refresh",size:"small"},on:{click:t.resetQuery}},[t._v("重置")])],1)],1)],1)],1),a("el-row",{attrs:{gutter:20}},[a("el-col",[a("el-row",{staticClass:"mb8",attrs:{gutter:10}},[a("el-col",{attrs:{span:2}},[a("el-button",{attrs:{type:"primary",plain:"",icon:"el-icon-plus",size:"mini"},on:{click:t.handleAdd}},[t._v("新增 ")])],1)],1),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],attrs:{data:t.userList}},[a("el-table-column",{attrs:{type:"index",align:"center",width:"60"}}),a("el-table-column",{attrs:{label:"学工号",align:"center",prop:"tutorId"}}),a("el-table-column",{attrs:{label:"姓名",align:"center",prop:"name"}}),a("el-table-column",{attrs:{label:"院系",align:"center",prop:"organizationName"}}),a("el-table-column",{attrs:{label:"用户角色",align:"center",prop:"roleName"}}),a("el-table-column",{attrs:{label:"创建时间",align:"center",prop:"createTime"}}),a("el-table-column",{attrs:{label:"操作",align:"center","class-name":"small-padding"},scopedSlots:t._u([{key:"default",fn:function(e){return 1!==e.row.userId?[a("el-button",{attrs:{size:"mini",type:"text",icon:"el-icon-edit"},on:{click:function(a){return t.handleEdit(e.row)}}},[t._v("修改 ")]),a("el-button",{attrs:{size:"mini",type:"text",icon:"el-icon-delete"},on:{click:function(a){return t.handleDelete(e.row.tutorId)}}},[t._v("删除 ")])]:void 0}}],null,!0)})],1),a("el-row",{attrs:{type:"flex",justify:"center"}},[a("el-pagination",{directives:[{name:"show",rawName:"v-show",value:t.total>0,expression:"total > 0"}],staticStyle:{margin:"5px 0"},attrs:{"current-page":t.queryParams.pageNum,"page-size":t.queryParams.pageSize,layout:"total, prev, pager, next",total:t.total},on:{"current-change":t.handleCurrentChange}})],1)],1)],1),a("el-dialog",{attrs:{title:t.isEdit?"编辑用户":"添加用户",visible:t.open},on:{"update:visible":function(e){t.open=e}}},[a("el-form",{ref:"form",attrs:{"label-width":"80px"}},[a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"学工号"}},[a("el-autocomplete",{staticClass:"inline-input",staticStyle:{width:"100%"},attrs:{"fetch-suggestions":t.querySearch,placeholder:"请输入学工号","trigger-on-focus":!1,disabled:t.isEdit},on:{select:t.handleSelect},model:{value:t.tutorId,callback:function(e){t.tutorId=e},expression:"tutorId"}})],1)],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{staticStyle:{width:"100%"},attrs:{label:"用户姓名",prop:"name"}},[a("p",{domProps:{textContent:t._s(t.name)}})])],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"角色"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{filterable:"",placeholder:"请选择"},model:{value:t.roleId,callback:function(e){t.roleId=e},expression:"roleId"}},[a("el-option",{attrs:{label:"院系秘书",value:"2"}}),a("el-option",{attrs:{label:"研究生院管理员",value:"4"}}),a("el-option",{attrs:{label:"社科处管理员",value:"6"}}),a("el-option",{attrs:{label:"科研处管理员",value:"7"}})],1)],1)],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"机构"}},[a("p",{domProps:{textContent:t._s(t.organizationName)}})])],1)],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:t.cancel}},[t._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:t.commitSystemUser}},[t._v("确 定")])],1)],1)],1)},r=[],l=(a("b0c0"),a("159b"),a("99af"),a("b775"));function o(t){return Object(l["a"])({url:"/admin/system-user/getAll",method:"post",data:t})}function s(t){return Object(l["a"])({url:"/admin/system-user/getQueryTutorId/".concat(t),method:"get"})}function i(t){return Object(l["a"])({url:"/admin/system-user/getSystemUserByTutorId/".concat(t),method:"get"})}function u(t,e){return Object(l["a"])({url:"/admin/system-user/addSystemUser/".concat(e),method:"post",data:t})}function c(t,e){return Object(l["a"])({url:"/admin/system-user/editSystemUser/".concat(t,"/").concat(e),method:"get"})}function d(t){return Object(l["a"])({url:"/admin/system-user/deleteSystemUser/".concat(t),method:"get"})}var m={data:function(){return{loading:!0,single:!1,total:0,userList:[],isEdit:!1,open:!1,currentPage:1,statusOptions:[{dictLabel:"启用",dictValue:0},{dictLabel:"禁用",dictValue:1}],organizationOptions:[],tutorId:"",name:"",organizationName:"",roleId:"",queryParams:{pageNum:1,pageSize:10,tutorId:"",name:"",roleId:""},user:null}},created:function(){this.getList()},methods:{getList:function(){var t=this;this.loading=!0,this.queryParams.pageNum=this.currentPage||1,o(this.queryParams).then((function(e){t.userList=e.data.users,t.total=e.data.total,t.loading=!1})).catch((function(t){throw t}))},querySearch:function(t,e){this.name="",this.organizationName="",s(t).then((function(t){var a=[];t.data.forEach((function(t){a.push({value:t})})),e(a)}))},handleSelect:function(t){var e=this;i(t.value).then((function(t){e.organizationName=t.data.organizationName,e.name=t.data.name,e.user=t.data})).catch((function(t){throw t}))},commitSystemUser:function(){var t=this;this.isEdit?c(this.tutorId,this.roleId).then((function(e){2e4===e.code&&(t.open=!1,t.$message.success("修改成功"),t.tutorId="",t.name="",t.organizationName="",t.roleId="",t.getList())})):null!==this.user&&""!==this.roleId?u(this.user,this.roleId).then((function(e){20001===e.code?t.$message.warning("此用户已经存在，若需修改权限，请在页面中修改"):t.$message.success("添加成功！"),t.open=!1,t.tutorId="",t.name="",t.organizationName="",t.roleId="",t.user=null,t.getList()})).catch((function(t){throw t})):this.$message.error("请填写信息")},cancel:function(){this.open=!1,this.reset()},reset:function(){this.form={userId:void 0,deptId:void 0,userName:void 0,status:"0",remark:void 0,postIds:[],roleIds:[]}},handleQuery:function(){this.queryParams.pageNum=1,this.getList()},resetQuery:function(){this.queryParams={pageNum:1,pageSize:10,tutorId:"",name:"",roleId:""},this.handleQuery()},handleAdd:function(){this.open=!0,this.isEdit=!1},handleEdit:function(t){this.isEdit=!0,this.open=!0,this.tutorId=t.tutorId,this.name=t.name,this.roleId=t.roleId+"",this.organizationName=t.organizationName},handleDelete:function(t){var e=this;this.$confirm('是否确认删除？删除不可撤销，请谨慎操作"！',"警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){d(t).then((function(t){2e4===t.code&&(e.$message.success("删除成功"),e.getList())}))}))},handleCurrentChange:function(t){this.currentPage=t,this.getList()}}},p=m,h=a("2877"),f=Object(h["a"])(p,n,r,!1,null,null,null);e["default"]=f.exports}}]);